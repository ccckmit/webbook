<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
  </style>
  <link rel="stylesheet" href="../css/book.css" type="text/css" />
</head>
<body>
<div id="header_wrap">
  <h1><a href="index.htm">電子書：Web 程式設計</a></h1>
  <table id="bar" border="0" style="border:0;"><tr style="border:0;">
    <td style="text-align:left;border:0;"> <a href="book.html">目錄</a> | <a href="download.html">下載</a> | <a href="course.html">課程</a> | <a href="forum.html">討論</a> | <a href="exam.html">測驗</a></td>
    <td style="text-align:right;border:0;"><a href="http://ccckmit.wikidot.com/">陳鍾誠</a> 於 <a href="http://www.nqu.edu.tw/">金門大學</a></td>
  </tr></table>
</div>
<div id="content">
<div id="TOC">
<ul>
<li><a href="#jquery-的延伸插件">jQuery 的延伸插件</a><ul>
<li><a href="#d-繪圖函式庫----jquery.flot">2D 繪圖函式庫 -- jQuery.flot</a></li>
<li><a href="#繪製任意函數-curve.htm----使用-jquery.flot">繪製任意函數 curve.htm -- 使用 jQuery.flot</a></li>
<li><a href="#相關套件">相關套件</a></li>
</ul></li>
</ul>
</div>
<h1 id="jquery-的延伸插件"><a href="#jquery-的延伸插件">jQuery 的延伸插件</a></h1>
<h2 id="d-繪圖函式庫----jquery.flot"><a href="#d-繪圖函式庫----jquery.flot">2D 繪圖函式庫 -- jQuery.flot</a></h2>
<ul>
<li>flot 是繪圖函式庫 -- <a href="http://people.iola.dk/olau/flot/examples/">http://people.iola.dk/olau/flot/examples/</a> (可互動，超讚！)</li>
<li>jquery.flot.image.js 可以讓 flot 所繪的圖輸出成為一個 image</li>
<li><a href="http://code.google.com/p/flot/source/browse/trunk/jquery.flot.image.js?r=194">http://code.google.com/p/flot/source/browse/trunk/jquery.flot.image.js?r=194</a></li>
</ul>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;html&gt;</span>
 <span class="kw">&lt;head&gt;</span>
    <span class="kw">&lt;meta</span><span class="ot"> http-equiv=</span><span class="st">&quot;Content-Type&quot;</span><span class="ot"> content=</span><span class="st">&quot;text/html; charset=utf-8&quot;</span><span class="kw">&gt;</span>
    <span class="kw">&lt;title&gt;</span>Flot Examples<span class="kw">&lt;/title&gt;</span>
    <span class="kw">&lt;link</span><span class="ot"> href=</span><span class="st">&quot;layout.css&quot;</span><span class="ot"> rel=</span><span class="st">&quot;stylesheet&quot;</span><span class="ot"> type=</span><span class="st">&quot;text/css&quot;</span><span class="kw">&gt;</span>
    <span class="co">&lt;!--[if lte IE 8]&gt;&lt;script language=&quot;javascript&quot; type=&quot;text/javascript&quot; src=&quot;../excanvas.min.js&quot;&gt;&lt;/script&gt;&lt;![endif]--&gt;</span>
    <span class="kw">&lt;script</span><span class="ot"> language=</span><span class="st">&quot;javascript&quot;</span><span class="ot"> type=</span><span class="st">&quot;text/javascript&quot;</span><span class="ot"> src=</span><span class="st">&quot;http://people.iola.dk/olau/flot/jquery.js&quot;</span><span class="kw">&gt;&lt;/script&gt;</span>
    <span class="kw">&lt;script</span><span class="ot"> language=</span><span class="st">&quot;javascript&quot;</span><span class="ot"> type=</span><span class="st">&quot;text/javascript&quot;</span><span class="ot"> src=</span><span class="st">&quot;http://people.iola.dk/olau/flot/jquery.flot.js&quot;</span><span class="kw">&gt;&lt;/script&gt;</span>
 <span class="kw">&lt;/head&gt;</span>
    <span class="kw">&lt;body&gt;</span>
    <span class="kw">&lt;div</span><span class="ot"> id=</span><span class="st">&quot;placeholder&quot;</span><span class="ot"> style=</span><span class="st">&quot;width:600px;height:300px;&quot;</span><span class="kw">&gt;&lt;/div&gt;</span>

<span class="kw">&lt;script</span><span class="ot"> type=</span><span class="st">&quot;text/javascript&quot;</span><span class="kw">&gt;</span>
<span class="er">$(function () {</span>
    <span class="kw">var</span> d1 = [], dcos=[];
    <span class="kw">for</span> (<span class="kw">var</span> i = <span class="dv">0</span>; i &lt; <span class="dv">14</span>; i += <span class="fl">0.5</span>)
<span class="er">        dcos.push([i, 5*Math.cos(i)]);</span>

    <span class="kw">for</span> (<span class="kw">var</span> i = <span class="dv">0</span>; i &lt; <span class="dv">14</span>; i += <span class="fl">0.5</span>)
<span class="er">        d1.push([i, Math.sin(i)]);</span>
        
    <span class="kw">var</span> d2 = [[<span class="dv">0</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">8</span>], [<span class="dv">8</span>, <span class="dv">5</span>], [<span class="dv">9</span>, <span class="dv">13</span>]];

    <span class="co">// a null signifies separate line segments</span>
    <span class="kw">var</span> d3 = [[<span class="dv">0</span>, <span class="dv">12</span>], [<span class="dv">7</span>, <span class="dv">12</span>], <span class="kw">null</span>, [<span class="dv">7</span>, <span class="fl">2.5</span>], [<span class="dv">12</span>, <span class="fl">2.5</span>]];
    
<span class="er">    $.plot($(&quot;#placeholder&quot;), [ dcos, d1, d2, d3 ]);</span>
});
<span class="kw">&lt;/script&gt;</span>

 <span class="kw">&lt;/body&gt;</span>
<span class="kw">&lt;/html&gt;</span></code></pre>
<h2 id="繪製任意函數-curve.htm----使用-jquery.flot"><a href="#繪製任意函數-curve.htm----使用-jquery.flot">繪製任意函數 curve.htm -- 使用 jQuery.flot</a></h2>
<p>為了繪製函數圖形，筆者曾經利用 jQuery.flot 設計了一個可以輸入 JavaScript 函數或程式，然後在畫面上繪出對應圖形的程式，在此列出以供大家參考。</p>
<ol style="list-style-type: decimal">
<li><p>您可以輸入任何單變數函數，變數名稱必須是 x，像是右圖中的 sin(x) 與 cos(x)。</p></li>
<li><p>您可以會出割線或切線，語法是 cut(f, a, dx)，其中 f 為某函數，割線的兩個端點分別為 (a,a+dx) ，如果 dx 很小，那畫出來的割線就差不多是切線了。</p></li>
<li><p>您也可以自行定義函數，像是右圖中的 f=function(x) { return 0.01*pow(x,3); } 這一行，代表 ，語法必須符合 JavaScript 語言。</p></li>
</ol>
<div class="figure">
<img src="../img/jQuery.Flot.GraphHtm.png" alt="curve.htm 的執行畫面" /><p class="caption">curve.htm 的執行畫面</p>
</div>
<p>程式碼：curve.htm</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;html&gt;</span>
 <span class="kw">&lt;head&gt;</span>
    <span class="kw">&lt;meta</span><span class="ot"> http-equiv=</span><span class="st">&quot;Content-Type&quot;</span><span class="ot"> content=</span><span class="st">&quot;text/html; charset=utf-8&quot;</span><span class="kw">&gt;</span>
    <span class="co">&lt;!--[if lte IE 8]&gt;&lt;script language=&quot;javascript&quot; type=&quot;text/javascript&quot; </span>
<span class="co">    src=&quot;../excanvas.min.js&quot;&gt;&lt;/script&gt;&lt;![endif]--&gt;</span>
    <span class="kw">&lt;script</span><span class="ot"> language=</span><span class="st">&quot;javascript&quot;</span><span class="ot"> type=</span><span class="st">&quot;text/javascript&quot;</span> 
<span class="ot">    src=</span><span class="st">&quot;http://people.iola.dk/olau/flot/jquery.js&quot;</span><span class="kw">&gt;&lt;/script&gt;</span>
    <span class="kw">&lt;script</span><span class="ot"> language=</span><span class="st">&quot;javascript&quot;</span><span class="ot"> type=</span><span class="st">&quot;text/javascript&quot;</span> 
<span class="ot">    src=</span><span class="st">&quot;http://people.iola.dk/olau/flot/jquery.flot.js&quot;</span><span class="kw">&gt;&lt;/script&gt;</span>
 <span class="kw">&lt;/head&gt;</span>
<span class="kw">&lt;body&gt;</span>

<span class="kw">&lt;div</span><span class="ot"> id=</span><span class="st">&quot;placeholder&quot;</span><span class="ot"> style=</span><span class="st">&quot;width:360px;height:240px;&quot;</span><span class="kw">&gt;&lt;/div&gt;</span>

<span class="kw">&lt;div&gt;</span>
from:<span class="kw">&lt;input</span><span class="ot"> id=</span><span class="st">&quot;from&quot;</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="ot"> value=</span><span class="st">&quot;-10&quot;</span><span class="ot"> size=</span><span class="st">&quot;4&quot;</span><span class="kw">/&gt;</span>
to:<span class="kw">&lt;input</span><span class="ot"> id=</span><span class="st">&quot;to&quot;</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="ot"> value=</span><span class="st">&quot;10&quot;</span><span class="ot"> size=</span><span class="st">&quot;4&quot;</span><span class="kw">/&gt;</span>
step:<span class="kw">&lt;input</span><span class="ot"> id=</span><span class="st">&quot;step&quot;</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="ot"> value=</span><span class="st">&quot;0.1&quot;</span><span class="ot"> size=</span><span class="st">&quot;4&quot;</span><span class="kw">/&gt;</span>
ymin:<span class="kw">&lt;input</span><span class="ot"> id=</span><span class="st">&quot;ymin&quot;</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="ot"> value=</span><span class="st">&quot;-1.5&quot;</span><span class="ot"> size=</span><span class="st">&quot;4&quot;</span><span class="kw">/&gt;</span>
ymax:<span class="kw">&lt;input</span><span class="ot"> id=</span><span class="st">&quot;ymax&quot;</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="ot"> value=</span><span class="st">&quot;1.5&quot;</span><span class="ot"> size=</span><span class="st">&quot;4&quot;</span><span class="kw">/&gt;</span>
<span class="kw">&lt;/div&gt;</span>

<span class="kw">&lt;textarea</span><span class="ot"> id=</span><span class="st">&quot;shell&quot;</span><span class="ot"> cols=</span><span class="st">&quot;60&quot;</span><span class="ot"> rows=</span><span class="st">&quot;10&quot;</span><span class="kw">&gt;</span>
sin(x)
cos(x)
cut(sin, -5, 0.01)(x)
f=function(x) { return 0.01*pow(x,3); }
f(x)
<span class="kw">&lt;/textarea&gt;</span>

<span class="kw">&lt;script</span><span class="ot"> type=</span><span class="st">&quot;text/javascript&quot;</span><span class="kw">&gt;</span>

<span class="kw">var</span> sin=<span class="ot">Math</span>.<span class="fu">sin</span>;
<span class="kw">var</span> cos=<span class="ot">Math</span>.<span class="fu">cos</span>;
<span class="kw">var</span> tan=<span class="ot">Math</span>.<span class="fu">tan</span>;
<span class="kw">var</span> cot=<span class="ot">Math</span>.<span class="fu">cot</span>;
<span class="kw">var</span> sec=<span class="ot">Math</span>.<span class="fu">sec</span>;
<span class="kw">var</span> csc=<span class="ot">Math</span>.<span class="fu">csc</span>;
<span class="kw">var</span> ceil=<span class="ot">Math</span>.<span class="fu">ceil</span>;
<span class="kw">var</span> exp=<span class="ot">Math</span>.<span class="fu">exp</span>;
<span class="kw">var</span> floor=<span class="ot">Math</span>.<span class="fu">floor</span>;
<span class="kw">var</span> log=<span class="ot">Math</span>.<span class="fu">log</span>;
<span class="kw">var</span> max=<span class="ot">Math</span>.<span class="fu">max</span>;
<span class="kw">var</span> min=<span class="ot">Math</span>.<span class="fu">min</span>;
<span class="kw">var</span> pow=<span class="ot">Math</span>.<span class="fu">pow</span>;
<span class="kw">var</span> p=<span class="ot">Math</span>.<span class="fu">pow</span>;
<span class="kw">var</span> random=<span class="ot">Math</span>.<span class="fu">random</span>;
<span class="kw">var</span> round=<span class="ot">Math</span>.<span class="fu">round</span>;
<span class="kw">var</span> abs=<span class="ot">Math</span>.<span class="fu">abs</span>;
<span class="kw">var</span> sqrt=<span class="ot">Math</span>.<span class="fu">sqrt</span>;

<span class="er">function cut(f, a, dx) {</span>
<span class="er">    var fa = f(a);</span>
<span class="er">    var fb = f(a+dx);</span>
    <span class="kw">return</span> <span class="kw">function</span>(x) { <span class="kw">return</span> fa + (fb-fa)/dx * (x-a); }
}

<span class="er">function ExpCurve(from, to, step) {</span>
  <span class="kw">this</span>.<span class="fu">from</span> = from;
  <span class="kw">this</span>.<span class="fu">to</span> = to;
  <span class="kw">this</span>.<span class="fu">step</span> = step;
  <span class="kw">this</span>.<span class="fu">plotsList</span> = [];

  <span class="kw">this</span>.<span class="fu">curve</span> = <span class="kw">function</span>(code, ymin, ymax) {
    <span class="kw">var</span> plots = [];
    <span class="kw">for</span> (<span class="kw">var</span> x = <span class="kw">this</span>.<span class="fu">from</span>; x &lt; <span class="kw">this</span>.<span class="fu">to</span>; x += <span class="kw">this</span>.<span class="fu">step</span>) {
        <span class="kw">var</span> y = <span class="fu">eval</span>(code);
        <span class="kw">if</span> (x &gt; <span class="kw">this</span>.<span class="fu">from</span> &amp;&amp; <span class="fu">abs</span>(y-ylast)/<span class="kw">this</span>.<span class="fu">step</span> &gt; <span class="fl">1000.0</span>) <span class="co">// 斜率太大，近乎垂直，中斷處不畫</span>
            <span class="ot">plots</span>.<span class="fu">push</span>(<span class="kw">null</span>);
        <span class="ot">plots</span>.<span class="fu">push</span>([x, y]);
        <span class="kw">if</span> (y &lt; ymin<span class="dv">-100</span> || y &gt; ymax<span class="dv">+100</span>) <span class="co">// 超出範圍，超出點不畫</span>
            <span class="ot">plots</span>.<span class="fu">push</span>(<span class="kw">null</span>);
        ylast = y;
    }
    <span class="kw">return</span> { <span class="dt">label</span>: code, <span class="dt">data</span>: plots };
  }

  <span class="kw">this</span>.<span class="fu">curveList</span> = <span class="kw">function</span>(codeList, ymin, ymax) {
    <span class="kw">var</span> size=<span class="kw">this</span>.<span class="ot">plotsList</span>.<span class="fu">length</span>;
    <span class="kw">for</span> (<span class="kw">var</span> i=<span class="dv">0</span>; i&lt;<span class="ot">codeList</span>.<span class="fu">length</span>; i++) {
        <span class="kw">if</span> (codeList[i].<span class="fu">indexOf</span>(<span class="st">&quot;=&quot;</span>) &gt;=<span class="dv">0</span>) {
            <span class="fu">eval</span>(codeList[i]);
            <span class="kw">this</span>.<span class="fu">plotsList</span>[size+i] = {};
        } <span class="kw">else</span>
            <span class="kw">this</span>.<span class="fu">plotsList</span>[size+i] = <span class="kw">this</span>.<span class="fu">curve</span>(codeList[i], ymin, ymax);
    }
    <span class="kw">return</span> <span class="kw">this</span>.<span class="fu">plotsList</span>;    
  }

  <span class="kw">return</span> <span class="kw">this</span>;
}

<span class="er">function drawCurveList(target, codeList, from, to, ymin, ymax, step) {</span>
<span class="er">  eval(&quot;fx = function(x) { return x; }&quot;);</span>
<span class="er">  var c = new ExpCurve(from, to, step);</span>
<span class="er">  $.plot($(target), c.curveList(codeList, ymin, ymax), {</span>
        yaxis: { <span class="dt">min</span>: ymin, <span class="dt">max</span>: ymax }, 
        series: {
            <span class="dt">lines</span>: { <span class="dt">show</span>: <span class="kw">true</span> },
            <span class="dt">points</span>: { <span class="dt">show</span>: <span class="kw">false</span> },
            <span class="dt">bars</span>: { <span class="dt">show</span>: <span class="kw">false</span>, <span class="dt">barWidth</span>: step }, 
        }  
  });
  <span class="kw">return</span> c;
}

<span class="er">function drawGraph() {</span>
<span class="er">    var from = eval($(&quot;#from&quot;).val());</span>
<span class="er">    var to   = eval($(&quot;#to&quot;).val());</span>
<span class="er">    var ymin = eval($(&quot;#ymin&quot;).val());</span>
<span class="er">    var ymax = eval($(&quot;#ymax&quot;).val());</span>
<span class="er">    var step = eval($(&quot;#step&quot;).val());</span>
<span class="er">    var codeList = $(&quot;#shell&quot;).val().split(&quot;\n&quot;);</span>
<span class="er">    return drawCurveList(&quot;#placeholder&quot;, codeList, from, to, ymin, ymax, step);</span>
}

<span class="er">function keyEnter(event) {</span>
  <span class="kw">if</span> (<span class="ot">event</span>.<span class="fu">which</span> == <span class="dv">13</span>) {
<span class="co">//     event.preventDefault();</span>
     <span class="fu">drawGraph</span>();
  }
}

<span class="er">$(drawGraph);</span>
<span class="er">$(&quot;#shell&quot;).keypress(keyEnter);</span>
<span class="er">$(&quot;#from&quot;).keypress(keyEnter);</span>
<span class="er">$(&quot;#to&quot;).keypress(keyEnter);</span>
<span class="er">$(&quot;#step&quot;).keypress(keyEnter);</span>
<span class="kw">&lt;/script&gt;</span>

 <span class="kw">&lt;/body&gt;</span>
<span class="kw">&lt;/html&gt;</span></code></pre>
<h2 id="相關套件"><a href="#相關套件">相關套件</a></h2>
<ul>
<li>D3JS: A new area of dashboarding
<ul>
<li><a href="http://diethardsteiner.blogspot.tw/2012/08/d3js-new-area-of-dashboarding.html?spref=fb">http://diethardsteiner.blogspot.tw/2012/08/d3js-new-area-of-dashboarding.html?spref=fb</a></li>
</ul></li>
<li>flot
<ul>
<li>Example : <a href="http://people.iola.dk/olau/flot/examples/">http://people.iola.dk/olau/flot/examples/</a> (可互動，超讚！)</li>
</ul></li>
<li>sparkline
<ul>
<li><a href="http://omnipotent.net/jquery.sparkline/2.0/jquery.sparkline.min.js">http://omnipotent.net/jquery.sparkline/2.0/jquery.sparkline.min.js</a></li>
</ul></li>
<li>jqPlot -- <a href="http://www.jqplot.com/tests/">http://www.jqplot.com/tests/</a>
<ul>
<li>與 jQuery 整合，樸素撰寫簡單。</li>
</ul></li>
<li>Flot -- <a href="http://people.iola.dk/olau/flot/examples/">http://people.iola.dk/olau/flot/examples/</a>
<ul>
<li>類似 jqPlot，但圖較優美，不過純粹是線圖。</li>
</ul></li>
<li><a href="http://www.filamentgroup.com/examples/jqueryui-visualize/">http://www.filamentgroup.com/examples/jqueryui-visualize/</a>
<ul>
<li>jqueryui-visualize -- 一行程式就完成了 $('table').visualize();</li>
</ul></li>
<li><a href="http://mbostock.github.com/d3/ex/stack.html">http://mbostock.github.com/d3/ex/stack.html</a>
<ul>
<li>高品質</li>
</ul></li>
<li><a href="http://www.highcharts.com/">http://www.highcharts.com/</a></li>
<li><a href="http://jsxgraph.uni-bayreuth.de/showcase/">http://jsxgraph.uni-bayreuth.de/showcase/</a>
<ul>
<li>科學計算圖</li>
</ul></li>
<li>5个主流jQuery图表生成插件评测
<ul>
<li><a href="http://blog.luluui.com/5-top-jquery-chart-libraries/">http://blog.luluui.com/5-top-jquery-chart-libraries/</a></li>
</ul></li>
<li>10 Best Javascript Drawing and Canvas Libraries
<ul>
<li><a href="http://javascript.open-libraries.com/utilities/drawing/10-best-javascript-drawing-and-canvas-libraries/">http://javascript.open-libraries.com/utilities/drawing/10-best-javascript-drawing-and-canvas-libraries/</a></li>
<li>Flotr Documentation -- <a href="http://solutoire.com/flotr/docs/">http://solutoire.com/flotr/docs/</a></li>
</ul></li>
</ul>
</div>
<div id="footer">
<a href="http://ccckmit.wikidot.com">陳鍾誠</a>衍生自<a href="http://zh.wikipedia.org/">維基百科</a>之作品：採用 <a href="http://creativecommons.org/licenses/by-sa/3.0/tw/ ">創作共用：姓名標示、相同方式分享</a> <a href="license.html">授權</a>
</div>
</body>
</html>
